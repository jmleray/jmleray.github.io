<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jean-Marie Le Ray — ORCID</title>

  <!-- Meta SEO (≈155 caractères) -->
  <meta name="description" content="CV ORCID de Jean-Marie Le Ray : bio, mots-clés cliquables, expériences, études et publications — généré automatiquement depuis data/person.xml. CC BY 4.0." />
  <meta name="robots" content="index,follow" />
  <meta name="format-detection" content="telephone=no" />
  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <!-- Micro-données minimales pour l’identité -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Person",
    "name":"Jean-Marie Le Ray",
    "url":"https://jmleray.github.io",
    "identifier":"https://orcid.org/0009-0006-7642-7408"
  }
  </script>

  <style>
    :root { --fg:#111; --muted:#666; --link:#0a58ca; --bg:#fff; --card:#f7f8fa; }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif}
    a{color:var(--link);text-decoration:none} a:hover{text-decoration:underline}
    .container{max-width:960px;margin:36px auto;padding:0 20px}
    header{margin-bottom:18px}
    h1{font-size:clamp(1.6rem,3.2vw,2.2rem);margin:0 0 6px}
    h2{font-size:1.15rem;margin:.2rem 0 .7rem}
    .muted{color:var(--muted)}
    section{background:var(--card);border:1px solid #e6e8eb;border-radius:12px;padding:16px 18px;margin:18px 0}
    ul{margin:.4rem 0 0 1.1rem}
    li+li{margin-top:.35rem}
    .hidden{display:none}
    .badge{display:inline-block;padding:.25rem .55rem;border-radius:.6rem;background:#eef;border:1px solid #ccd;margin:.18rem .28rem 0 0;font-size:.85rem}
    .badge:hover{background:#e6ecff}
    code.small{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:.85rem;background:#f2f3f5;padding:.15rem .35rem;border-radius:.35rem}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1 id="name">Jean-Marie Le Ray</h1>
      <div class="muted" id="strap">ORCID non chargé</div>
      <div class="muted" style="margin-top:6px">
        Données : <code class="small">data/person.xml</code> (ORCID) — Licence : <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> — Site : <a href="https://jmleray.github.io">jmleray.github.io</a>
      </div>
    </header>

    <section id="bioBox" class="hidden">
      <h2>Bio</h2>
      <div id="bio"></div>
    </section>

    <section id="keywordsBox" class="hidden">
      <h2>Mots-clés</h2>
      <div id="keywords"></div>
    </section>

    <section id="employmentBox" class="hidden">
      <h2>Expériences</h2>
      <ul id="employment"></ul>
    </section>

    <section id="educationBox" class="hidden">
      <h2>Études</h2>
      <ul id="education"></ul>
    </section>

    <section id="worksBox" class="hidden">
      <h2>Publications / Travaux</h2>
      <ul id="works"></ul>
    </section>

    <footer class="muted" style="margin-top:28px">
      Généré côté client à partir d’ORCID XML. Aucun cookie.
    </footer>
  </div>

  <script>
    /* --------- Utilitaires robustes (agnostiques des espaces de noms) --------- */
    const byLocal = (node, local) => {
      const out = [];
      const walker = document.createTreeWalker(node, NodeFilter.SHOW_ELEMENT, {
        acceptNode(el){ return el.localName === local ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP; }
      });
      for (let n; (n = walker.nextNode());) out.push(n);
      return out;
    };
    const firstLocal = (node, local) => byLocal(node, local)[0] || null;
    const text = el => (el && el.textContent || '').trim();
    const yearOf = d => { const y = firstLocal(d, 'year'); return y ? text(y) : ''; };
    const show = id => document.getElementById(id).classList.remove('hidden');

    /* --------- Mapping des mots-clés vers des liens --------- */
    const KW_LINKS = {
      // AI / IA
      "ai": "https://arxiv.org/abs/2510.19877",
      "artificial intelligence": "https://arxiv.org/pdf/2510.19877",
      "ia": "https://adscriptum.blogspot.com/p/ia.html",
      "intelligence artificielle": "https://formationsenia.blogspot.com/",

      // Generative AI
      "generative ai": "https://arxiv.org/abs/2509.02506",
      "ia générative": "https://fr.wikipedia.org/wiki/Intelligence_artificielle_g%C3%A9n%C3%A9rative",

      // LLM
      "llm": "https://adscriptum.blogspot.com/2025/07/ia-le-reve-impense-de-diderot-et.html",
      "grand modèle de langage": "https://fr.wikipedia.org/wiki/Grand_mod%C3%A8le_de_langage",

      // Machine Translation
      "machine translation": "https://pucci-in-english.blogspot.com/2025/07/the-history-of-machine-translation-in.html",
      "traduction automatique": "https://zenodo.org/records/17360312",

      // Federico Pucci
      "federico pucci": "https://adscriptum.blogspot.com/p/federico-pucci.html"
    };
    const fallbackLink = term => `https://www.google.com/search?q=${encodeURIComponent(term)}`;
    const linkForKeyword = k => KW_LINKS[k.toLowerCase().trim()] || fallbackLink(k);

    /* --------- Extraction propre des mots-clés ORCID --------- */
    const keywordLabel = (kEl) => {
      const c = firstLocal(kEl, 'content');
      if (c) return text(c);
      const direct = Array.from(kEl.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.nodeValue.trim())
        .join(' ')
        .trim();
      return direct;
    };
    const uniqueSorted = arr => Array.from(new Set(arr.filter(Boolean).map(s => s.trim())))
      .sort((a,b) => a.localeCompare(b,'fr',{sensitivity:'base'}));

    /* --------- Bio propre (commencer par “French…”, sans dates/IDs) --------- */
    const cleanBio = bioEl => {
      if (!bioEl) return '';
      const c = firstLocal(bioEl, 'content');
      let s = c ? text(c)
        : Array.from(bioEl.childNodes)
            .filter(n => n.nodeType === Node.TEXT_NODE)
            .map(n => n.nodeValue.trim())
            .join(' ')
            .trim();
      s = s.replace(/^(?:\d{4}-\d{2}-\d{2}T[\d:.Z+-]+[\s,;]*)+/, '').trim();
      return s;
    };

    async function loadORCID(){
      try{
        const res = await fetch('data/person.xml', { cache: 'no-store' });
        if(!res.ok) throw new Error('HTTP '+res.status);
        const xml = await res.text();
        const doc = new DOMParser().parseFromString(xml, 'application/xml');

        const person = firstLocal(doc,'person') || doc;

        // Nom
        const credit = text(firstLocal(person,'credit-name'));
        const given = text(firstLocal(person,'given-names'));
        const family = text(firstLocal(person,'family-name'));
        const display = credit || [given,family].filter(Boolean).join(' ') || 'Nom ORCID';
        document.getElementById('name').textContent = display;

        // ORCID iD (si présent)
        const idPath = firstLocal(firstLocal(doc,'orcid-identifier')||doc,'path');
        const orcidId = idPath ? text(idPath) : '0009-0006-7642-7408';
        document.getElementById('strap').innerHTML = orcidId
          ? `Profil ORCID : <a href="https://orcid.org/${orcidId}" rel="me">https://orcid.org/${orcidId}</a>`
          : 'Profil ORCID';

        // Bio
        const bio = cleanBio(firstLocal(person,'biography'));
        if (bio){
          document.getElementById('bio').textContent = bio;
          show('bioBox');
        }

        // Mots-clés (cliquables)
        const kwRoot = firstLocal(person,'keywords');
        if (kwRoot){
          const kws = uniqueSorted(byLocal(kwRoot,'keyword').map(keywordLabel));
          if (kws.length){
            document.getElementById('keywords').innerHTML =
              kws.map(k => `<a class="badge" href="${linkForKeyword(k)}" target="_blank" rel="noopener noreferrer">${k}</a>`).join(' ');
            show('keywordsBox');
          }
        }

        // Expériences
        const employment = byLocal(doc,'employment-summary');
        if (employment.length){
          const items = employment.map(e=>{
            const org = firstLocal(e,'organization');
            const orgName = org ? text(firstLocal(org,'name')) : '';
            const role = text(firstLocal(e,'role-title'));
            const start = firstLocal(e,'start-date'); const end = firstLocal(e,'end-date');
            const ys = start ? yearOf(start):''; const ye = end?yearOf(end):'';
            const period = (ys||ye)?` (${ys||'…'}–${ye||'…'})`:'';
            if (!orgName && !role) return '';
            return `<li><strong>${orgName||role}</strong>${(orgName&&role)?' — '+role:''}${period}</li>`;
          }).filter(Boolean).join('');
          if (items){ document.getElementById('employment').innerHTML = items; show('employmentBox'); }
        }

        // Études
        const education = byLocal(doc,'education-summary');
        if (education.length){
          const items = education.map(e=>{
            const org = firstLocal(e,'organization');
            const orgName = org ? text(firstLocal(org,'name')) : '';
            const role = text(firstLocal(e,'role-title')) || text(firstLocal(e,'department-name'));
            const start = firstLocal(e,'start-date'); const end = firstLocal(e,'end-date');
            const ys = start ? yearOf(start):''; const ye = end?yearOf(end):'';
            const period = (ys||ye)?` (${ys||'…'}–${ye||'…'})`:'';
            if (!orgName && !role) return '';
            return `<li><strong>${orgName||role}</strong>${(orgName&&role)?' — '+role:''}${period}</li>`;
          }).filter(Boolean).join('');
          if (items){ document.getElementById('education').innerHTML = items; show('educationBox'); }
        }

        // Travaux / Publications (jusqu’à 50)
        const works = byLocal(doc,'work-summary');
        if (works.length){
          const items = works.slice(0,50).map(w=>{
            const tWrap = firstLocal(w,'title') || w;
            const t = firstLocal(tWrap,'title');
            const title = text(t) || '(sans titre)';
            const pub = firstLocal(w,'publication-date');
            const y = pub ? yearOf(pub) : '';
            const journal = text(firstLocal(w,'journal-title'));

            // Lien (priorité DOI)
            let link = '';
            for (const ext of byLocal(w,'external-id')){
              const type = text(firstLocal(ext,'external-id-type')).toLowerCase();
              const val  = text(firstLocal(ext,'external-id-value'));
              if (type === 'doi' && val){ link = 'https://doi.org/'+val; break; }
              if (!link && type === 'url' && val){ link = val; }
            }
            const head = link ? `<a href="${link}" target="_blank" rel="noopener">${title}</a>` : title;
            const meta = [journal,y].filter(Boolean).join(' · ');
            return `<li>${head}${meta ? ` — <span class="muted">${meta}</span>` : ''}</li>`;
          }).join('');
          if (items){ document.getElementById('works').innerHTML = items; show('worksBox'); }
        }

      }catch(err){
        document.getElementById('strap').textContent = 'Impossible de charger ORCID ('+err.message+')';
      }
    }

    loadORCID();
  </script>
</body>
</html>
